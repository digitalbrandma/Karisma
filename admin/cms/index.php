<?php /* Textolite v1.03 */ ini_set('error_reporting',E_ALL);ini_set('display_errors',0);ini_set('log_errors',1);ini_set('error_log','error.log');ini_set('date_default_timezone_set','UTC');final class Q{private $v;private $r;public function __construct(){$this->v['g']=$_GET;$this->v['p']=$_POST;$this->v['s']=$_SERVER;$this->v['c']=$_COOKIE;$this->v['f']=$_FILES;}public function q(){if(isset($this->v['g']['query'])){return $this->v['g']['query'];}}public function s($k=false,$t=false){if(isset($this->r['s'][$k])){return $this->r['s'][$k];}else{$u=strtoupper($k);if(isset($this->v['s'][$u])){if(!$t){$t=$k;}return $this->r['s'][$k]=$this->h($this->v['s'][$u],$t);}}}public function p($k=false,$t=false){if($k){if(isset($this->r['p'][$k])){return $this->r['p'][$k];}else{if(isset($this->v['p'][$k])){return $this->r['p'][$k]=$this->h($this->v['p'][$k],$t);}}}else if(count($this->v['p'])){return true;}}public function c($k,$t=false){if(isset($this->r['c'][$k])){return $this->r['c'][$k];}else{if(isset($this->v['c'][$k])){return $this->r['c'][$k]=$this->h($this->v['c'][$k],$t);}}}public function f($k){if(isset($this->v['f'][$k])){return $this->v['f'][$k];}}private function h($v,$t){if($t and $h='h_'.$t and method_exists($this,$h)){return $this->$h($v);}else return $v;}private function h_server_protocol($s){preg_match('~^[a-z]{4,5}/[0-9]\.[0-9]$~i',$s,$m);if(isset($m[0])){return $m[0];}}private function h_server_name($s){preg_match('~^[a-z0-9-_\.]{2,300}$~i',$s,$m);if(isset($m[0])){return $m[0];}}private function h_document_root($s){if(substr($s,-1)=='/'){return substr($s,0,-1);}return $s;}private function h_http_accept_language($s){preg_match('~[a-z]{2}~i',strtolower(substr($s,0,2)),$m);if(isset($m[0])){return $m[0];}}private function h_remote_addr($s){return $this->h_ip($s);}private function h_server_addr($s){return $this->h_ip($s);}private function h_ip($s){preg_match('~^[a-z0-9\.\:]{1,40}$~i',$s,$m);if(isset($m[0])){return $m[0];}}private function h_sha1($s){preg_match('~^[a-z0-9]{40}$~i',$s,$m);if(isset($m[0])){return $m[0];}}}final class P{private $p;private $e;private $o;private $d;public function __construct($p){$this->p=$p;$this->h('Content-type:text/html;charset=utf-8');}public function h($s){return $this->e[]=$s;}public function s($c,$m){return $this->e[]=$this->p.' '.$c.' '.$m;}public function r($u){return $this->e[]='Location:'.$u;}public function c($n,$v=false,$e=false,$p=false,$d=false,$s=false,$h=false){$c['n']=$n;$c['v']=$v;$c['h']=$h;$c['e']=(int)$e;$c['p']=$p;$c['d']=$d;$c['s']=(int)$s;$this->o[]=$c;}public function k($n,$p=false,$d=false){$this->c($n,'',time()-60*60,$p,$d);}public function b($d){return $this->d=$d;}public function a(){if(isset($this->e)){foreach($this->e as $h){header($h);}}if(isset($this->o)){foreach($this->o as $c){setcookie($c['n'],$c['v'],$c['e'],$c['p'],$c['d'],$c['s'],$c['h']);}}if(isset($this->d)){print $this->d;}}}final class S{const l="\n";const c='conf.ini';private $p;private $l;private $x;private $o;private $m;private $v;public function __construct($r,$h,$q){$this->p['r']=$r;$this->p['h']=$h;$this->p['a']=str_replace($h,'',$r);$this->p['s']=$this->ed($r);$this->p['u']=$this->ed($this->p['a']);$this->o=parse_ini_file($r.self::c,true);$this->x=array('ru'=>array('404'=>'Страница не найдена','307'=>'Временное перенаправление','403'=>'Доступ запрещен','files'=>'Файлы','filename'=>'Имя','filesize'=>'Размер','changed'=>'Изменён','menu'=>'Меню','settings'=>'Настройки','password'=>'Пароль','authorization'=>'Авторизация','login'=>'Войти','logout'=>'Выход','edit'=>'Изменить','save'=>'Сохранить','not_save'=>'Не сохранять','saving'=>'Сохранение','saved'=>'Изменения сохранены','not_saved'=>'Изменения не сохранены','session_remove'=>'Сброс сессии','access_closed'=>'Доступ закрыт','request_rejected'=>'Запрос отклонён','no_response'=>'Сервер не отвечает','old_browser'=>'Нужен новый браузер','hash_creating'=>'Создание хеша','checking_password'=>'Проверка пароля','access_granted'=>'Доступ разрешен','access_denied'=>'Доступ запрещен','required_javascript'=>'Нужен JavaScript','new_version'=>'Доступна новая версия','need_updade'=>'Необходимо обновить систему','file_upload'=>'Загрузка файлов','file_upload_complete'=>'Загрузка файлов завершена','file_upload_error'=>'Сбой в загрузке файлов','file_upload_count'=>'Лимит сервера на количество файлов за раз','file_upload_size'=>'Лимит сервера на размер файла','file_removal'=>'Удаление файла','file_removed'=>'Файл успешно удалён','file_remove_error'=>'Сбой в удалении файла','add_file'=>'Добавить файл','remove_file'=>'Удалить файл','removal_confirm'=>'Подтверждение удаления','file_remove_cancel'=>'Отменить удаление','show_password'=>'Показать пароль','hide_password'=>'Скрыть пароль','changing_password'=>'Изменение пароля','old_password'=>'Старый пароль','new_password'=>'Новый пароль','password_changed'=>'Пароль изменен','wrong_password'=>'Неверный пароль'),'en'=>array('404'=>'Not Found','307'=>'Temporary Redirect','403'=>'Forbidden','files'=>'Files','filename'=>'Name','filesize'=>'Size','changed'=>'Changed','menu'=>'Menu','settings'=>'Settings','password'=>'Password','authorization'=>'Login','login'=>'Enter','logout'=>'Logout','edit'=>'Edit','save'=>'Save','not_save'=>'Do not save','saving'=>'Saving','saved'=>'Changes have been saved','not_saved'=>'Changes are not saved','session_remove'=>'Ending a session','access_closed'=>'Access is closed','request_rejected'=>'Request is rejected','no_response'=>'Server is not responding','old_browser'=>'Requires a newer browser','hash_creating'=>'Password hashing','checking_password'=>'Password checking','access_granted'=>'Access granted','access_denied'=>'Access denied','required_javascript'=>'Requires JavaScript','new_version'=>'New version is available','need_updade'=>'Requires a newer version','file_upload'=>'Uploading files','file_upload_complete'=>'Files uploaded','file_upload_error'=>'Failure in file uploading','file_upload_count'=>'Number of files exceeds server limit','file_upload_size'=>'File size exceeds server limit','file_removal'=>'File deletion','file_removed'=>'File is deleted','file_remove_error'=>'Failure in file deletion','add_file'=>'Add file','remove_file'=>'Delete file','removal_confirm'=>'Confirm','file_remove_cancel'=>'Cancel','show_password'=>'Show password','hide_password'=>'Hide password','changing_password'=>'Password changing','old_password'=>'Old password','new_password'=>'New password','password_changed'=>'Password changed','wrong_password'=>'Wrong password'));$this->m=array('head'=>'<link rel="stylesheet" href="{root}textolite.css">','body'=>'<div id="textolite-panel"><div><div><h1><span>T</span>exto<span>lite</span></h1><p>Site editor <span>v{version}</span></p></div><ol><li>html</li><li>text</li></ol><ul><li><a>{files}</a><div id="textolite-files"><ol><li>{filename}</li><li>{filesize}</li><li>{changed}</li><li>{menu}</li></ol><ul>{filelist}</ul></div></li><li><a>{settings}</a><div id="textolite-settings"><fieldset><legend>{changing_password}</legend><dl><dt>{old_password}:</dt><dd><input type="password" maxlength="14"><a></a></dd><dt>{new_password}:</dt><dd><input type="password" maxlength="14"><a></a></dd></dl><p><input type="button" value="{edit}" disabled></p></fieldset></div></li></ul><ul><li><input type="button" value="{save}" disabled></li><li><input type="button" value="{logout}" disabled data-confirm="{not_save}"></li></ul><p><samp data-saving="{saving}" data-saved="{saved}" data-not-saved="{not_saved}" data-session-remove="{session_remove}" data-access-closed="{access_closed}" data-request-rejected="{request_rejected}" data-no-response="{no_response}" data-old-browser="{old_browser}" data-new-version="{new_version}" data-need-updade="{need_updade}" data-hash-сreating="{hash_creating}" data-hash-depth="{hash_depth}" data-file-upload="{file_upload}" data-file-upload-complete="{file_upload_complete}" data-file-upload-error="{file_upload_error}" data-file-upload-count="{file_upload_count}" data-file-upload-size="{file_upload_size}" data-file-removal="{file_removal}" data-file-removed="{file_removed}" data-file-remove-error="{file_remove_error}" data-сhanging-password="{changing_password}" data-password-changed="{password_changed}" data-wrong-password="{wrong_password}" data-show-password="{show_password}" data-hide-password="{hide_password}" data-post-max-size="{post_max_size}" data-upload-max-filesize="{upload_max_filesize}" data-max-file-uploads="{max_file_uploads}" data-ip="{ip}" data-is-edited="{is_edited}" data-version="{version}"></samp><noscript><samp>{required_javascript}</samp></noscript><i></i></p></div></div><script src="{root}textolite.js"></script><script type="text/template" id="textolite-block"><var class="textolite-block" contenteditable></var></script><script type="text/template" id="textolite-source">{source}</script>','login'=>'<!doctype html><html id="textolite-login" lang="ru"><head><title>{authorization} - Textolite</title><link rel="stylesheet" href="{root}textolite.css"></head><body><fieldset><legend>{authorization}</legend><ol data-error-limit="{error_limit}" data-error-count="{error_count}"><li></li></ol><p><samp data-hash-сreating="{hash_creating}" data-сhecking-password="{checking_password}" data-access-granted="{access_granted}" data-access-denied="{access_denied}" data-no-response="{no_response}"></samp><noscript><samp>{required_javascript}</samp></noscript><i></i></p><p><span>{password}:</span><input type="password" data-hash-depth="{hash_depth}" maxlength="14"><a data-show-password="{show_password}" data-hide-password="{hide_password}"></a></p><p><input type="button" value="{login}" disabled></p></fieldset><script src="{root}textolite.js"></script></body></html>','error'=>'<!doctype html><html id="textolite-error" lang="ru"><head><title>{code} - {{code}} - Textolite</title><link rel="stylesheet" href="{root}textolite.css"></head><body><samp><span>{code}</span> {{code}}</samp></body></html>','source'=>'<!doctype html><html id="textolite-editor" lang="ru"><head><title>{title}</title><link rel="stylesheet" href="{root}textolite.css"></head><body><ol data-item="<li style=height:0px></li>"></ol><pre contenteditable></pre></body></html>','filelist_folder'=>'<li><ol class="textolite-folder"><li><a data-url="{url}">{name}</a></li><li>{size}</li><li>{date}</li><li><i title="{add_file}"></i></li></ol><ul></ul></li>','filelist_file'=>'<li><ol class="textolite-file"><li><a data-url="{url}">{name}</a></li><li>{size}</li><li>{date}</li><li><i title="{remove_file}"></i><i title="{removal_confirm}"></i><i title="{file_remove_cancel}"></i></li></ol></li>');if(stripos($s=$this->c('lang'),',')and stripos($s,$q)){$this->l=$q;}else $this->l=substr($s,0,2);}public function __destruct(){if($this->v){$this->g();}}public function u(){return $this->p['a'];}public function s(){return $this->p['u'];}public function d(){return $this->p['s'];}public function r(){return $this->p['r'];}public function h(){return $this->p['h'];}public function c($k,$s=false){if($s){if(isset($this->o[$s][$k])){return $this->o[$s][$k];}}else{if(isset($this->o[$k])){return $this->o[$k];}}}public function f($k,$v,$s=false){if($s){if(isset($this->o[$s])){$this->v=true;return $this->o[$s][$k]=$v;}}else{$this->v=true;return $this->o[$k]=$v;}}private function g(){foreach($this->o as $s=>$r){if(!is_array($r)){$l[]=$s.'='.$r.self::l.self::l;}}foreach($this->o as $s=>$r){if(is_array($r)){$l[]='['.$s.']'.self::l.self::l;foreach($r as $k=>$v){$l[]="\t".$k.'='.$v.self::l;}$l[]=self::l;}}if($e=fopen($this->p['r'].self::c,'w')){flock($e,LOCK_EX);fwrite($e,implode('',$l));flock($e,LOCK_UN);fclose($e);}}public function t($k,$v=false){if(isset($this->m[$k])){return $this->n($this->i($this->m[$k],$v));}}public function i($t,$v){if($v){foreach($v as $n=>$l){$t=str_ireplace('{'.$n.'}',$l,$t);}}return $t;}public function n($t){preg_match_all('~\{([a-z0-9_]{2,30})\}~i',$t,$m);if($m[1]){$m[1]=array_unique($m[1]);foreach($m[1] as $k){if($v=$this->e($k)){$t=str_ireplace('{'.$k.'}',$v,$t);}}}return $t;}public function e($k){if(isset($this->x[$this->l][$k])){return $this->x[$this->l][$k];}}public function ed($p){if(substr_count($p,'/')>2){return dirname($p).'/';}else return '/';}}final class E{const v='1.03';private $z;private $q;private $j;public function __construct($z,$q,$j){$this->z=$z;$this->q=$q;$this->j=$j;}public function c(){$a=$this->q->c('textolite_session','sha1');if($a&&$a==$this->z->c('session')){$this->p();}else{$b=$this->z->c('login_error_list');$g=$this->z->c('login_error_limit');$c=$this->q->s('remote_addr');if($b&&isset($b[$c])){$d=$b[$c];}else $d=0;$e=time();if($this->q->p()&&$this->q->s('http_ajax')){$f=$this->q->p('password','sha1');if($f&&($d<$g||$this->z->c('login_last_error_time')+($this->z->c('login_lockout_duration')*60)<$e)){$h=$this->z->c('password');$y6=$this->z->c('client_hash_depth')*1;$t5=$this->z->c('full_hash_depth')*1;$k=$t5-$y6;for($j=0;$j<$k;$j++){$f=sha1($f);}if($h==$f){$this->s();if(isset($b[$c])){unset($b[$c]);$this->z->f('login_error_list',$b);}if($y6<5){$this->z->f('client_hash_depth',15000);}else$this->z->f('client_hash_depth',$y6-1);}else{$this->z->f('login_last_error_time',$e);$this->z->f($c,$d+1,'login_error_list');$this->j->s(404,$this->z->e('404'));}}else $this->j->s(404,$this->z->e('404'));}else{if($d<$g||$this->z->c('login_last_error_time')+($this->z->c('login_lockout_duration')*60)<$e){$m['root']=$this->z->u();$m['error_limit']=$g;$m['error_count']=$d;$m['hash_depth']=$this->z->c('client_hash_depth');$this->j->b($this->z->t('login',$m));}else throw new Exception(false,403);}}}public function p(){$a=$this->q->q();if(!$a){if($this->q->s('script_filename')!=str_replace('\\','/',__FILE__)){$this->rb();}throw new Exception($this->z->u().'index.html',307);}$b=$this->z->d().$a;if($this->q->s('http_ajax')){if($this->q->p('logout')){$this->m();}else if(($c=$this->q->p('save'))&&($token=$this->q->p('token','sha1'))&&($token==$this->q->c('textolite_token','sha1'))){$this->j->k('textolite_token');$c=str_replace('<.script','</script',rawurldecode($c));if($d=fopen($b,'w')){flock($d,LOCK_EX);fwrite($d,$c);flock($d,LOCK_UN);fclose($d);}}else if($e=$this->q->p('open')){$e=rawurldecode($e);$k4=$this->f($e);if($k4===false){$this->z->f('filelist','');$k4=$this->f($e);}if($k4!==false){if(substr_count($e,'/')==substr_count($this->z->s(),'/')){$this->j->h('X-System-URL:'.$this->z->u());}else if(strrpos($e,$this->z->u())!==false){$this->j->h('X-System-Folder:1');}$this->j->b($k4);}else $this->j->s(404,$this->z->e('404'));}else if(($e=$this->q->p('upload'))&&($f=$this->q->p('token','sha1'))&&($f==$this->q->c('textolite_token','sha1'))){$this->j->k('textolite_token');$e=rawurldecode($e);$g=$this->z->h().$e;$h=$this->q->f('file');if($count=count($h)and is_dir($g)){$i='';$j=$this->z->t('filelist_file');foreach($h['tmp_name'] as $k=>$l){$m=$this->u($g.$h['name'][$k]);move_uploaded_file($l,$g.$h['name'][$k]);$b=$g.$m;$n['name']=$m;$n['date']=filemtime($b);$n['size']=filesize($b);$ln=strtolower($n['name']);if(substr($ln,-5)=='.html'||substr($ln,-4)=='.htm'){$n['url']=$this->z->u().substr($e,strlen($this->z->s())).$n['name'];}else $n['url']=$e.$n['name'];$i.=$this->z->i($j,$n);}$this->z->f('filelist','');$o=$this->l($e);$p=$o['size'];foreach($h['error'] as $k=>$q){if($h['error'][$k]){$i='';}}$this->j->h('X-Folder-Size:'.$p);$this->j->b($i);}else $this->j->s(404,$this->z->e('404'));}else if(($r=$this->q->p('remove'))&&($f=$this->q->p('token','sha1'))&&($f==$this->q->c('textolite_token','sha1'))){$this->j->k('textolite_token');$r=rawurldecode($r);$b=$this->z->h().$r;$b=str_replace($this->z->u(),$this->z->s(),$b);if(is_file($b)&&unlink($b)){$this->z->f('filelist','');$s=$this->l($this->z->ed($r));$this->j->h('X-Folder-Size:'.$s['size']);}else $this->j->s(404,$this->z->e('404'));}else if(($t=$this->q->p('change','sha1'))&&($u=$this->q->p('password','sha1'))){$v=$this->z->c('password');$w=$this->z->c('full_hash_depth')-$this->z->c('client_hash_depth');for($x=0;$x<$w;$x++){$u=sha1($u);}if($v==$u){for($x=0;$x<$w;$x++){$t=sha1($t);}if($t!=$u){$this->z->f('password',$t);}$this->j->h('X-Password-Changed:1');}else $this->j->h('X-Wrong-Password:1');}else if ($this->q->p('reload')){$this->s();}else $this->j->s(404,$this->z->e('404'));}else{$this->s();if(file_exists($b)){$y=$this->q->c('textolite_html');$z=$this->q->p('switch');$v['is_edited']='';if(is_numeric($z)){$q=$this->q->p('source');if($q&&($f=$this->q->p('token','sha1'))&&$f==$this->q->c('textolite_token','sha1')){$this->j->h('X-XSS-Protection:0');$this->j->k('textolite_token');$v['is_edited']='1';$q=str_replace('<.script','</script',$q);}else $q=$this->ht($b);if($z==='1'&&!$y){$y=true;$this->j->c('textolite_html',1,time()+60*60*24*90,$this->z->u(),false,false,true);}if($z==='0'&&$y){$y=false;$this->j->k('textolite_html',$this->z->u());}}else $q=$this->ht($b);if($y){preg_match('~<title>(.{1,150})<~i',$q,$h5);if(isset($h5[1])){$h6=$h5[1];}else $h6='';$c=$this->z->t('source',array('title'=>$h6,'root'=>$this->z->u()));}else{$c=$q;$c=str_replace('</head>',$this->z->t('head',array('root'=>$this->z->u())).'</head>',$c);}$v['source']=str_replace('</script','<.script',$q);}else{$v['is_edited']='';$v['source']='';$c=$this->z->t('error',array('code'=>'404','root'=>$this->z->u()));}$v['root']=$this->z->u();$v['ip']=$this->q->s('server_addr');$v['version']=self::v;$v['filelist']=$this->o($this->z->s());$v['hash_depth']=$this->z->c('client_hash_depth');$v['post_max_size']=$this->b(ini_get('post_max_size'));$v['upload_max_filesize']=$this->b(ini_get('upload_max_filesize'));$v['max_file_uploads']=ini_get('max_file_uploads');$c=str_replace('</body>',$this->z->t('body',$v).'</body>',$c);$this->j->b($c);}}public function ht($a){$r=file_get_contents($a);preg_match('~<meta[^>]+windows-1251~i',$r,$m);if(isset($m[0])){$r=preg_replace('~(<meta[^>]+)windows-1251~i','$1utf-8',$r);$r=iconv('Windows-1251','UTF-8',$r);}return $r;}public function b($v){$v=strtolower(trim($v));switch($v[strlen($v)-1]){case'm':return $v*1048576;case'k':return $v*1024;case'g':return $v*1073741824;default:return $v;}}public function u($f){if(file_exists($f)){preg_match('~\.[a-z0-9]{1,5}$~i',$f,$m);if(isset($m[0])){$b=preg_replace('~\.([a-z0-9]{1,5})$~i','(backup1).$1',$f);}else $b+='(backup1)';for($i=1;file_exists($b);$i++){$b=preg_replace('~\(backup'.$i.'\)~i','(backup'.($i+1).')',$b);}rename($f,$b);}else $b=$f;return preg_replace('~^.*/~i','',$b);}public function f($u){$t=$this->d($u);if($t!==false){$r='';$d=$this->z->t('filelist_folder');$f=$this->z->t('filelist_file');foreach($t as $k){if(isset($k['list'])){unset($k['list']);$r.=$this->z->i($d,$k);}else $r.=$this->z->i($f,$k);}return $r;}else return false;}public function d($u){$f=$this->i();if($u!='/'){$gj=$this->z->s();if($gj!='/'){if($u==$gj){$p=false;}else $p=substr(str_replace($gj,'',$u),0,-1);}else $p=substr($u,1,-1);}else $p=false;$r=$f['list'];if($p){$p=explode('/',$p);foreach($p as $n){foreach($r as $m){if($m['name']==$n){$r=$m['list'];break;}}if($r!=$m['list']){$r=false;break;}}}return $r;}public function o($u){$d=$this->l($u);unset($d['list']);return $this->z->t('filelist_folder',$d);}public function l($u){$f=$this->i($u);if($u!='/'){$gj=$this->z->s();if($gj!='/'){if($u==$gj){$p=false;}else $p=substr(str_replace($gj,'',$u),0,-1);}else $p=substr($u,1,-1);}else $p=false;$r=$f;if($p){$p=explode('/',$p);foreach($p as $n){foreach($r['list'] as $m){if($m['name']==$n){$r=$m;break;}}if($r!=$m){$r=false;}}}return $r;}public function i(){$f=$this->z->c('filelist');if(!$f){$f=$this->r($this->z->s());$this->z->f('filelist',urlencode(serialize($f)));}else $f=unserialize(urldecode($f));return $f;}public function r($u){$d=$this->z->h().$u;if($u=='/'){$r['name']=$this->q->s('server_name');}else $r['name']=substr($u,strrpos(substr($u,0,-1),'/')+1,-1);$r['date']=filemtime($d);$r['size']=0;$r['url']=$u;$x=$z=array();if($h=opendir($d)){while(($n=readdir($h))!==false){if($n!='.'&&$n!='..'){$f=array();if(is_file($d.$n)){$f['name']=$n;$f['size']=filesize($d.$n);$f['date']=filemtime($d.$n);$ln=strtolower($n);if(substr($ln,-5)=='.html'||substr($ln,-4)=='.htm'){$f['url']=$this->z->u().substr($u,strlen($this->z->s())).$n;}else $f['url']=$u.$n;$z[]=$f;}else{$f=$this->r($u.$n.'/');$x[]=$f;}$r['size']+=$f['size'];}}closedir($h);}$r['list']=array_merge($x,$z);return $r;}public function rb(){$c=file_get_contents($this->z->r().'.htaccess');preg_match('~RewriteBase (.+?)\n~i',$c,$m);if(isset($m[0])&&isset($m[1])){if($m[1]!=$this->z->u()){$c=str_replace($m[0],'RewriteBase '.$this->z->u()."\n",$c);$this->hr($c);}}else{$c=preg_replace('~(RewriteEngine .+?\n)~i','$1'."\n".'RewriteBase '.$this->z->u()."\n",$c);$this->hr($c);}}public function hr($c){if($f=fopen($this->z->r().'.htaccess','w')){flock($f,LOCK_EX);fwrite($f,$c);flock($f,LOCK_UN);fclose($f);}}public function s(){$s=sha1(time().mt_rand());$this->z->f('session',$s);$this->j->c('textolite_session',$s,time()+60*15,$this->z->u(),false,false,true);}public function m(){$this->z->f('session','');$this->j->k('textolite_session',$this->z->u());}public function x($e){$this->j->s($e->getCode(),$this->z->e($e->getCode()));if($u=$e->getMessage()){$this->j->r($u);}$v['root']=$this->z->u();$v['code']=$e->getCode();$this->j->b($this->z->t('error',$v));}}$q=new Q();$p=new P($q->s('server_protocol'));$s=new S(dirname($q->s('script_filename')).'/',$q->s('document_root'),$q->s('http_accept_language'));$e=new E($s,$q,$p);try{$e->c();}catch(Exception $x){$e->x($x);}$p->a();?>